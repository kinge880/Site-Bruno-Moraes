{% comment %} 
  Variáveis esperadas na view:
  - title: Título da seção (ex: 'Gerenciar Categorias')
  - search_placeholder: Texto do input de busca (ex: 'Buscar categoria...')
  - search_name: Nome do campo GET (ex: 'name', 'q', etc)
  - button_label: Texto do botão (ex: 'Nova Categoria')
  - data: lista de objetos
  - headers: lista de strings (cabeçalhos da tabela)
  - fields: lista de nomes de atributo do modelo para exibir (ordem igual ao headers)
  - object_id_field: nome do campo que representa o ID (ex: 'id')
{% endcomment %}
{% load custom_tags %}
<!-- Mensagens Django -->
{% if messages %}
<div class="space-y-3">
    {% for message in messages %}
        <div class="rounded-md p-4 text-sm font-medium
            {% if 'success' in message.tags %}
            bg-green-100 text-green-800
            {% elif 'danger' in message.tags %}
            bg-red-100 text-red-800
            {% else %}
            bg-gray-100 text-gray-800
            {% endif %}
        ">
            {{ message|safe }}
        </div>
    {% endfor %}
</div>
{% endif %}

<div class="w-full bg-white shadow-md sm:rounded-lg">
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 px-4 py-4 border-b border-gray-200">
      <h2 class="text-lg font-semibold text-gray-700">{{ title }}</h2>
  
      <div class="flex flex-col sm:flex-row gap-2 w-full sm:w-auto">
        <form method="GET" action="" class="relative w-full sm:w-72">
          <span class="absolute inset-y-0 left-0 flex items-center pl-3">
            <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-4.35-4.35M10 18a8 8 0 100-16 8 8 0 000 16z" />
            </svg>
          </span>
          <input
            type="text"
            name="{{ search_name }}"
            value="{{ request.GET.search_name|default:'' }}"
            class="block w-full pl-10 pr-4 py-2 text-sm border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500 bg-gray-50"
            placeholder="{{ search_placeholder }}"
          >
        </form>
  
        <div>
          <button 
            type="button" @click="open = true"
            class="w-full sm:w-auto bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700">
            {{ button_label }}
          </button>
        </div>
      </div>
    </div>
  
    <!-- Tabela (desktop) -->
    <div class="overflow-x-auto">
      <table class="min-w-full text-sm text-left text-gray-700 hidden md:table">
        <thead class="text-xs text-gray-600 uppercase bg-gray-100 border-b border-gray-200">
          <tr>
            {% for header in headers %}
              <th class="px-6 py-3">{{ header }}</th>
            {% endfor %}
            <th class="px-6 py-3 text-center">Ações</th>
          </tr>
        </thead>
        <tbody>
          {% for obj in data %}
          <tr class="border-b hover:bg-gray-50">
            {% for field in fields %}
              <td class="px-6 py-4">{{ obj|get_attr:field }}</td>
            {% endfor %}
            <td class="px-6 py-4 text-center">
              <button type="button" @click="categoryToDelete = {{ obj|get_attr:object_id_field }}; openDelete = true" class="text-red-600 hover:text-red-800">Excluir</button>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  
    <!-- Cards (mobile) -->
    <div class="md:hidden px-4 space-y-4 py-4">
      {% for obj in data %}
      <div class="border rounded-lg p-4 shadow-sm bg-white">
        {% for field, label in field_labels %}
        <div class="mb-2">
            <span class="block text-xs text-gray-500">{{ label }}</span>
            <p class="text-gray-800">{{ obj|get_attr:field }}</p>
        </div>
        {% endfor %}
        <div class="flex justify-end pt-2">
          <button type="button" @click="categoryToDelete = {{ obj|get_attr:object_id_field }}; openDelete = true" class="text-red-600 hover:text-red-800 text-sm font-medium">
            Excluir
          </button>
        </div>
      </div>
      {% endfor %}
    </div>
  
    <!-- Paginação -->
    {% if page_obj.has_other_pages %}
      <div class="mt-4 flex justify-center space-x-2">
        {% if page_obj.has_previous %}
          <a href="?page={{ page_obj.previous_page_number }}" class="px-3 py-1 bg-gray-200 rounded">Anterior</a>
        {% endif %}
        {% for num in page_obj.paginator.page_range %}
          {% if page_obj.number == num %}
            <span class="px-3 py-1 bg-indigo-600 text-white rounded">{{ num }}</span>
          {% else %}
            <a href="?page={{ num }}" class="px-3 py-1 bg-gray-200 rounded">{{ num }}</a>
          {% endif %}
        {% endfor %}
        {% if page_obj.has_next %}
          <a href="?page={{ page_obj.next_page_number }}" class="px-3 py-1 bg-gray-200 rounded">Próxima</a>
        {% endif %}
      </div>
    {% endif %}
  </div>
  